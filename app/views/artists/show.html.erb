<%
  set_meta_tags(
    title: @artist.name,
    description: @artist.description,
  )
%>

<div class="flex flex-row border-b-2 border-b-slate-100 pb-6">
  <div class="basis-1/4 mr-4 m:mr-0">
    <% if @artist.profile_picture.representable? %>
    <%= image_tag @artist.profile_picture.representation(resize_to_limit: [150, 150]), class: 'm-auto' %>
    <% end %>
  </div>
  <div class="basis-3/4">
    <h2 class="text-2xl font-semibold"><%= @artist.name %></h2>
    <p class="text-slate-400 mb-4"><%= @artist.location %></p>
    <p><%= @artist.description %></p>
  </div>
</div>

<div class="pt-4 grid grid-cols-3 gap-4">
  <% @albums.published.in_release_order.each do |album| %>
    <%= link_to(artist_album_path(album.artist, album)) do %>
    <div>
      <div class="border border-slate-200">
        <% if album.cover.representable? %>
        <%= image_tag album.cover.representation(resize_to_limit: [1000, 1000]), class: 'w-full' %>
        <% end %>
      </div>
      <p class='text-sm text-slate-500'><%= album.title %></p>
    </div>
    <% end %>
  <% end %>

  <% if policy(@artist).view_unpublished_albums? %>
    <% @albums.unpublished.in_release_order.each do |album| %>
      <%= link_to(artist_album_path(album.artist, album)) do %>
        <div>
          <div class="border border-slate-200">
          <% if album.cover.representable? %>
          <%= image_tag album.cover.representation(resize_to_limit: [1000, 1000]), class: 'w-full' %>
          <% end %>
          </div>
          <p class='text-sm text-slate-500'><%= album.title %> (unpublished)</p>
        </div>
      <% end %>
    <% end %>
  <% end %>

  <% content_for :navbar do %>
    <% if policy(@artist).edit? %>
      <%= link_to "Edit artist", edit_artist_path(@artist), class: 'px-2 py-1 bg-amber-600 hover:bg-amber-500 text-white cursor-pointer text-sm' %>
    <% end %>

    <% if policy(@artist.albums.new).new? %>
      <%= link_to "Add album", new_artist_album_path(@artist), class: 'px-2 py-1 bg-amber-600 hover:bg-amber-500 text-white cursor-pointer text-sm' %>
    <% end %>
  <% end %>
</div>
